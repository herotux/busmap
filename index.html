<!DOCTYPE html>
<html>
<head>
	
	<title>Bus map</title>

	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
<link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />
<link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" />
<link rel="stylesheet" href="https://cdn.rtlcss.com/bootstrap/v4.0.0/css/bootstrap.min.css" integrity="sha384-P4uhUIGk/q1gaD/NdgkBIl3a6QywJjlsFJFk7SPRdruoGddvRVSwv5qFnvZ73cpz" crossorigin="anonymous">
<script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
<script src="dist/leaflet.awesome-markers.js"></script>
<script src="dist/kshmap.js"></script>
<link rel="stylesheet" href="dist/leaflet.awesome-markers.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.css">
<script src="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.js"></script>
<link rel="stylesheet" href="dist/L.Control.Sidebar.css" />
<script src="dist/L.Control.Sidebar.js"></script>

<style>
		p.rtl {
			direction: rtl;
		}
	</style>
</head>
<body>

<div>
	<div id="mapid" style="width: auto; height: 900px;">
		<div id="sidebar">
				<ul class="list-group">
					<li class="list-group-item">مسیرها</li>
					
					
					<li class="list-group-item list-group-item-primary">میدان فردوسی ـ میدان آزادی</li>
					<li class="list-group-item list-group-item-secondary">خط ۲ <span style="color:red;font-weight:bold">بزودی</span></li>
					<li class="list-group-item list-group-item-success">خط ۳ <span style="color:red;font-weight:bold">بزودی</span></li>
					<li class="list-group-item list-group-item-danger">خط ۴ <span style="color:red;font-weight:bold">بزودی</span></li>
					<li class="list-group-item list-group-item-warning">خط ۵ <span style="color:red;font-weight:bold">بزودی</span></li>
					<li class="list-group-item list-group-item-info">خط ۶ <span style="color:red;font-weight:bold">بزودی</span></li>
					<li class="list-group-item list-group-item-light">خط ۷ <span style="color:red;font-weight:bold">بزودی</span></li>
					<li class="list-group-item list-group-item-dark">خط ۸ <span style="color:red;font-weight:bold">بزودی</span></li>
				</ul>
				
				<h3>باس مپ</h3>
				<p>
						
					باس مپ یه سرویس برای پیدا کردن ایستگاه های اتوبوس و مسیریابی با اتوبوس است.
					ما اطلاعاتمون رو از نقشه osm گرفتیم و نقشه رو روی سرور شخصی راه اندازی کردیم(فقط کرمانشاه) و بعد اطلاعات ایستگاه های اتوبوس رو در لایه ای مجزا به نقشه اضافه کردیم.تاکید میکنم ایستگاه هایی که در نقشه osm ثبت شده بود که خیلی محدود بودند.
					
					قرار خیلی زود مسیرها رو هم اضافه کنیم ولی اول باید همه ایستگاه ها به نقشه اضافه بشه برای این کار به کمک همه نیاز داریم
				</p>
				<h3>چطور به پروژه کمک کنم؟</h3>
				<p>	
					برای اینکه بتونید تو یه پروژه متن باز همکاری کنید حتما نیاز نیست کدنویسی بلد باشید.
					کافیه یکی از برنامه های زیر رو دانلود کنید و ایستگاه های اتوبوس رو به نقشه open street map .اضافه کنید
					
					بین تعداد زیادی برنامه که از نقشه osm پشتیبانی میکنند اپلیکیشن mapsme رو پیشنهاد میکنم:
					برای نصب این برنامه کافیه از پلی استور عبارت maps.me رو جستجو کنید و برنامه مورد نظر رو دانلود کنید
					این برنامه به شما امکان استفاده از نقشه osm و مسیریابی بصورت آفلاین رو میده و همچنین به شما اجازه میده نقطه ای رو به نقشه اضافه کنید این نقطه میتونه ایستگاه اتوبوس هم باشه .
				</p>

		</div>
	</div>
</div>




<script>

	// mapview creation
	var mymap = L.map('mapid').setView([34.3587427, 47.0728447], 16);
// Add a tile layer to the mapview
	L.tileLayer('http://149.56.252.54/tile/{z}/{x}/{y}.png', {
		maxZoom: 22,
		
		attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a>',
	}).addTo(mymap);


	L.easyButton( 'fa-location-arrow', function(){
		mymap.locate({setView: true, maxZoom: 16});
	}).addTo(mymap);

	L.easyButton( 'fa-map-signs', function(){
		sidebar.toggle();
	}).addTo(mymap);


	var sidebar = L.control.sidebar('sidebar', {
		closeButton: true,
		position: 'right'
	});
	
	mymap.addControl(sidebar);
	setTimeout(function () {
		sidebar.show();
	}, 500);



	// Check sidebar visibility
	var visible = sidebar.isVisible();



	function onEachFeature(feature, layer) {
		var popupContent = "<p>ایستگاه اتوبوس " +
				feature.properties.name + "</p>";
		if (feature.properties && feature.properties.popupContent) {
			popupContent += feature.properties.popupContent;
		}
		layer.bindPopup(popupContent);
	}

	L.geoJson(kshbus, {
			style: function (feature) {
				return feature.properties && feature.properties.style;
			},
			onEachFeature: onEachFeature,
			pointToLayer: function (feature, latlng) {
				return L.marker(latlng,{icon: L.AwesomeMarkers.icon({icon: 'fa-bus', prefix: 'fa', markerColor: 'yellow', spin:true})
			});
			}
		}).addTo(mymap);

	L.geoJson(line10, {
   		
	}).addTo(mymap);

	var popup = L.popup();

	// function onMapClick(e) {
	// 	popup
	// 		.setLatLng(e.latlng)
	// 		.setContent("شما اینجا کلیک کردید " + e.latlng.toString())
	// 		.openOn(mymap);
	// }
	mymap.on('click', function () {
            sidebar.hide();
        })

//location find
	function onLocationFound(e) {
    var radius = e.accuracy / 2;

    L.marker(e.latlng).addTo(mymap)
        .bindPopup("You are within " + radius + " meters from this point").openPopup();

    L.circle(e.latlng, radius).addTo(mymap);
	}
	mymap.on('locationfound', onLocationFound);	
	mymap.locate({setView: true, maxZoom: 16});

	function onLocationError(e) {
    alert(e.message);
	}
	mymap.on('locationerror', onLocationError);



	
	
	
	mymap.on('sidebar', sidebarr);
	mymap.zoomControl.setPosition('topright');
  
</script>

</body>
</html>




