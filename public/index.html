<!DOCTYPE html>
<html>
<head>
    <title>Bus map</title>

    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="dist/images/markers-matte.png" sizes="16x16" type="image/png"> 
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.0.3/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.0.3/dist/leaflet.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.1/css/bootstrap.min.css" />
	<link rel="stylesheet" href="https://cdn.rtlcss.com/bootstrap/v4.0.0/css/bootstrap.min.css" integrity="sha384-P4uhUIGk/q1gaD/NdgkBIl3a6QywJjlsFJFk7SPRdruoGddvRVSwv5qFnvZ73cpz" crossorigin="anonymous">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.1.0/css/all.css" integrity="sha384-lKuwvrZot6UHsBSfcMvOkWwlCMgc0TaWr+30HWe3a4ltaBwTZhyTEggF5tJv8tbt" crossorigin="anonymous">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.css">
	<script src="https://cdn.jsdelivr.net/npm/leaflet-easybutton@2/src/easy-button.js"></script>
    <link rel="stylesheet" href="css/leaflet-sidebar.css" />

    <style>
        body {
            padding: 0;
            margin: 0;
        }
        html, body, #map {
            height: 100%;
            font: 10pt "Helvetica Neue", Arial, Helvetica, sans-serif;
        }
        .lorem {
            font-style: italic;
            color: #AAA;
        }
    </style>
</head>
<body>
    <div id="sidebar" class="sidebar collapsed">
        <!-- Nav tabs -->
        <div class="sidebar-tabs">
            <ul role="tablist">
                <li><a href="#home" role="tab"><i class="fas fa-bus"></i></a></li>
                <li><a href="#profile" role="tab"><i class="fa fa-map-signs"></i></a></li>
                <li class="disabled"><a href="#messages" role="tab"><i class="fa fa-envelope"></i></a></li>
                <li><a href="https://gitlab.com/freetux/busmap" role="tab" target="_blank"><i class="fab fa-gitlab"></i></a></li>
            </ul>

            <ul role="tablist">
                <li><a href="#settings" role="tab"><i class="fa fa-gear"></i></a></li>
            </ul>
        </div>

        <!-- Tab panes -->
        <div class="sidebar-content">
            <div class="sidebar-pane" id="home">
                <h1 class="sidebar-header">
                    باس مپ 
                    <span class="sidebar-close"><i class="fa fa-caret-right"></i></span>
                </h1>
                <p dir="rtl">
						
					باس مپ یه سرویس برای پیدا کردن ایستگاه های اتوبوس و مسیریابی با اتوبوس است.
					ما اطلاعاتمون رو از نقشه osm گرفتیم و نقشه رو روی سرور شخصی راه اندازی کردیم(فقط کرمانشاه) و بعد اطلاعات ایستگاه های اتوبوس رو در لایه ای مجزا به نقشه اضافه کردیم.تاکید میکنم ایستگاه هایی که در نقشه osm ثبت شده بود که خیلی محدود بودند.
					
					قرار خیلی زود مسیرها رو هم اضافه کنیم ولی اول باید همه ایستگاه ها به نقشه اضافه بشه برای این کار به کمک همه نیاز داریم
				</p>
				<h3>چطور به پروژه کمک کنم؟</h3>
				<p dir="rtl">	
					برای اینکه بتونید تو یه پروژه متن باز همکاری کنید حتما نیاز نیست کدنویسی بلد باشید.
					کافیه یکی از برنامه های زیر رو دانلود کنید و ایستگاه های اتوبوس رو به نقشه open street map .اضافه کنید
					
					بین تعداد زیادی برنامه که از نقشه osm پشتیبانی میکنند اپلیکیشن mapsme رو پیشنهاد میکنم:
					برای نصب این برنامه کافیه از پلی استور عبارت maps.me رو جستجو کنید و برنامه مورد نظر رو دانلود کنید
					این برنامه به شما امکان استفاده از نقشه osm و مسیریابی بصورت آفلاین رو میده و همچنین به شما اجازه میده نقطه ای رو به نقشه اضافه کنید این نقطه میتونه ایستگاه اتوبوس هم باشه .
				</p>

            </div>

            <div class="sidebar-pane" id="profile">
                <h1 class="sidebar-header">مسیر ها<span class="sidebar-close"><i class="fa fa-caret-right"></i></span></h1>
                <ul class="list-group">
					<li class="list-group-item">مسیرها</li>
					
					
					<li class="list-group-item list-group-item-primary">میدان فردوسی ـ میدان آزادی</li>
					<li class="list-group-item list-group-item-secondary">خط ۲ <span style="color:red;font-weight:bold">بزودی</span></li>
					<li class="list-group-item list-group-item-success">خط ۳ <span style="color:red;font-weight:bold">بزودی</span></li>
					<li class="list-group-item list-group-item-danger">خط ۴ <span style="color:red;font-weight:bold">بزودی</span></li>
					<li class="list-group-item list-group-item-warning">خط ۵ <span style="color:red;font-weight:bold">بزودی</span></li>
					<li class="list-group-item list-group-item-info">خط ۶ <span style="color:red;font-weight:bold">بزودی</span></li>
					<li class="list-group-item list-group-item-light">خط ۷ <span style="color:red;font-weight:bold">بزودی</span></li>
					<li class="list-group-item list-group-item-dark">خط ۸ <span style="color:red;font-weight:bold">بزودی</span></li>
				</ul>
            </div>

            <div class="sidebar-pane" id="messages">
                <h1 class="sidebar-header">Messages<span class="sidebar-close"><i class="fa fa-caret-right"></i></span></h1>
            </div>

            <div class="sidebar-pane" id="settings">
                <h1 class="sidebar-header">Settings<span class="sidebar-close"><i class="fa fa-caret-right"></i></span></h1>
            </div>
        </div>
    </div>

    <div id="map" class="sidebar-map"></div>
    <link rel="stylesheet" href="dist/leaflet.awesome-markers.css">
    <script src="dist/leaflet.awesome-markers.js"></script>
	<script src="dist/kshmap.js"></script>
    <script src="js/leaflet-sidebar.js"></script>

    <script>

        // mapview creation
        var mymap = L.map('map').setView([34.3587427, 47.0728447], 12);

        // Add a tile layer to the mapview
        var map = L.tileLayer('http://149.56.252.54/tile/{z}/{x}/{y}.png', {
            maxZoom: 22,
            
            attribution: '<a href="http://freetux.gitlab.io">Hamdi Saydy</a>|Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a>',
        }).addTo(mymap);
    

        L.easyButton( 'fa-location-arrow', function(){
            mymap.locate({setView: true, maxZoom: 12});
        }).addTo(mymap);



        var sidebar = L.control.sidebar('sidebar', {position: 'right'}).addTo(mymap);
    
    
    
        function onEachFeature(feature, layer) {
            var popupContent = "<p>ایستگاه  " +
                    feature.properties.name + "</p>";
            if (feature.properties && feature.properties.popupContent) {
                popupContent += feature.properties.popupContent;
            }
            layer.bindPopup(popupContent);
        }
        
    
        var buses = L.geoJson(kshbus, {
                style: function (feature) {
                    return feature.properties && feature.properties.style;
                },
                onEachFeature: onEachFeature,
                pointToLayer: function (feature, latlng) {
                    return L.marker(latlng,{icon: L.AwesomeMarkers.icon({icon: 'fa-bus', prefix: 'fa', markerColor: 'yellow'})
                });
                }
            }).addTo(mymap);
    
       var routes =  L.geoJson(line10, {
               
        })


        var baseMaps = {
            "نقشه": map,
        };

        var overlayMaps = {
            "ایستگاه ها": buses,
            "مسیر ها" : routes
        };
        
        L.control.layers(baseMaps, overlayMaps, { collapsed: false }).addTo(mymap);

        var popup = L.popup();
    
        function onMapClick(e) {
        	popup
        		.setLatLng(e.latlng)
        		.setContent("شما اینجا کلیک کردید " + e.latlng.toString())
        		.openOn(mymap);
        }
        mymap.on('click', onMapClick);
    
    //location find
        function onLocationFound(e) {
        var radius = e.accuracy / 2;
    
        L.marker(e.latlng).addTo(mymap)
            .bindPopup("You are within " + radius + " meters from this point").openPopup();
    
        L.circle(e.latlng, radius).addTo(mymap);
        }
        mymap.on('locationfound', onLocationFound);	
        mymap.locate({setView: true, maxZoom: 16});
    
        function onLocationError(e) {
        alert(e.message);
        }
        mymap.on('locationerror', onLocationError);
        
        
    </script>
</body>
</html>